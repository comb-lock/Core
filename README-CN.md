[English Version](/README.md)

## 核心功能说明
密码锁的核心功能由加解密、存读取两部分组成。

具体操作上的流程为：（选择文档）-> 验证密码 -> 记录/读取。

文档结构：纯文本，每行为一条记录。通过逗号分隔，前者是记录项，后者是备注。最后一行为字符串 `'success'` 的密文，用于验证密码是否正确。

加解密方式：由唯一的`根密码`通过 `AES-256 CBC` 算法对`整个文档`进行加解密，之后进行 `Base64` 编码处理，以便于加密文档的保存和传输。根密码可为任意字符串，通过取 `MD5` 散列值的方式转换为32位密码。


## 客户端规则
为了保证安全，在实际开发时推荐遵守如下规则：

- 每次客户端关闭之后，再次使用均应验证根密码。不能保留状态。
- 客户端不应该申请任何非必要的权限。
- 在记录或读取的过程中发生错误，应明确告知用户操作失败的结果。
- 如果更改密码，要明确提示用户并删除使用之前密码的加密文档。
- 新建一个文档时，对于初始根密码的要求应该达到较高的强度：必须存在 大写字母 + 小写字母 + 数字 + 特殊符号，并不得少于8位。


## 演示（bash test）
下面将演示如何`手动`完成基本的加解密步骤。参考提供的demo，你可以自行通过其他方式实现。

#### 使用Python脚本（仅在 MacOS Python3.7 测试过）：

0. 需要 pycrypto 库
```bash
pip install pycrypto
```

1. 通过根密码加入一条新记录（已建立的空Lock文档，密码即示例中的 `IAMp0ssW@rd` ，可直接加入/查看记录）

```bash
# 参数列表：
# 根密码：任意字符串 
# add ：添加记录的标志
# 要添加的记录 ：字符串
# 对记录的提示：字符串
# （可选）加密文档位置：默认为当前目录下的 Lock 文件

python comb_lock_core.py IAMp0ssW@rd add 'i am a secret' 'i am a note' [./Lock]
```

2. 通过根密码查看记录

```bash
# 参数列表： 
# 根密码 
# read：读取记录的标志
# （可选）加密文档位置：默认为当前目录下的 Lock 文件

python comb_lock_core.py IAMp0ssW@rd read [./Lock]
```

3. 新建加密文档

```bash
# 参数列表： 
# 根密码
# new：新建文档的标志
# 加密文档位置：新建时必须指定新文档位置，不能跟已有的文件重名

python comb_lock_core.py IAMn3wP@ss new ./Lock2
```


#### 通过在线加解密网站等工具

手动对加密文档进行修改和查看，只要保持文档的结构不变，各行数据的密码一致即可。

不过，为什么不用一个安全简单的客户端呢 ? :) 